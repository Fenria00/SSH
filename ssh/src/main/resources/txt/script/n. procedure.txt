*Oracle procedure like map object
CREATE OR REPLACE PROCEDURE        "EXE_QUERY_TICKET_DATA" (
  TICKETID IN VARCHAR2,
  CURSORPARAM OUT SYS_REFCURSOR
)
IS
  V_TR1_NAME       NVARCHAR2(100);   --問題原因第一層
  V_TR2_NAME       NVARCHAR2(200);   --問題原因第二層
  V_TR3_NAME       NVARCHAR2(200);   --問題原因第三層
  V_PROC           NVARCHAR2(200);   --處理結果
BEGIN
-- Create by Ziv 20170615 for API : queryTicketData
   SELECT   
          nvl(CASE WHEN IS_COMMON_TROUBLE_REASON = '1' THEN GET_CFG_ADMIN_CONFIG(TROUBLE_REASON_ONE_ID) 
            ELSE GET_TICKET_REASON(TROUBLE_REASON_ONE_ID) END,' '),
          nvl(GET_CFG_ADMIN_CONFIG(TROUBLE_REASON_TWO_ID),' '),
          nvl(GET_CFG_ADMIN_CONFIG(TROUBLE_REASON_THREE_ID),' '),
          nvl(CASE WHEN IS_COMMON_PROC_RESULT = '1' THEN GET_CFG_ADMIN_CONFIG(PROC_RESULT_ID) 
            ELSE GET_TICKET_REASON(PROC_RESULT_ID) END,' ')
          INTO 
          V_TR1_NAME ,
          V_TR2_NAME , 
          V_TR3_NAME , 
          V_PROC
  FROM CUR_TICKET_MAIN
  WHERE ID = TICKETID;
 
  OPEN CURSORPARAM FOR
  
    SELECT 
      'troubleReasonOneName' FILE_NAME,
      TO_CHAR(V_TR1_NAME) FILE_VALUE    
    FROM dual
    UNION
    SELECT 
      'troubleReasonTwoName' FILE_NAME,
      TO_CHAR(V_TR2_NAME) FILE_VALUE    
    FROM dual
    UNION
    SELECT 
      'troubleReasonThreeName' FILE_NAME,
      TO_CHAR(V_TR3_NAME) FILE_VALUE    
    FROM dual
    UNION
    SELECT 
      'procResultName' FILE_NAME,
      TO_CHAR(V_PROC) FILE_VALUE    
    FROM dual;
      
COMMIT;
END EXE_QUERY_TICKET_DATA; 